@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>.
@prefix list: <http://www.w3.org/2000/10/swap/list#>.
@prefix log: <http://www.w3.org/2000/10/swap/log#>.
@prefix lingua: <http://www.w3.org/2000/10/swap/lingua#>.
@prefix : <http://example.org/ns#>.

:test1
    :policy :PolicyX;
    :has :A, :B, :C.

:PolicyX
    a :Policy;
    :allOf :A, :B;
    :anyOf :C;
    :noneOf :D.

:acp_rule1 a lingua:BackwardRule;
    lingua:conclusion (
        _:Pol :pass :allOfTest
    );
    lingua:premise (
        _:Test :policy _:Pol
        _:Pol rdf:type :Policy
        (
            (
                _:Pol :allOf _:Field
            )
            (
                _:Test :has _:Field
            )
        ) log:forAllIn _:X
    );
    lingua:varCount 4.

:acp_rule2 a lingua:BackwardRule;
    lingua:conclusion (
        _:Pol :pass :anyOfTest
    );
    lingua:premise (
        _:Test :policy _:Pol
        _:Pol rdf:type :Policy
        (
            _:Field
            (
                _:Pol :anyOf _:Field
                _:Test :has _:Field
            )
            _:List
        ) log:collectAllIn _:X
        _:List list:length _:L
        _:L log:notEqualTo 0
    );
    lingua:varCount 6.

:acp_rule3 a lingua:BackwardRule;
    lingua:conclusion (
        _:Pol :pass :noneOfTest
    );
    lingua:premise (
        _:Test :policy _:Pol
        _:Pol rdf:type :Policy
        (_:Field (
                _:Pol :noneOf _:Field
                _:Test :has _:Field
            ) _:List) log:collectAllIn _:X
        _:List list:length _:L
        _:L log:equalTo 0
    );
    lingua:varCount 6.

# query
:acp_query a lingua:QueryRule;
    lingua:premise (
        _:Pol rdf:type :Policy
        _:Pol :pass :allOfTest
        _:Pol :pass :anyOfTest
        _:Pol :pass :noneOfTest
    );
    lingua:conclusion (
        :test :for _:Pol
        :test :is true
    );
    lingua:varCount 1.
