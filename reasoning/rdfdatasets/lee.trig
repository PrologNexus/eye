# -----------------------------
# Lee routing for VLSI circuits
# -----------------------------
#
# Code from the book "The Art of Prolog" Chapter 16

@prefix math: <http://www.w3.org/2000/10/swap/math#>.
@prefix list: <http://www.w3.org/2000/10/swap/list#>.
@prefix log: <http://www.w3.org/2000/10/swap/log#>.
@prefix var: <http://www.w3.org/2000/10/swap/var#>.
@prefix : <#>.

_:bng_1 log:isImpliedBy _:bng_2.
_:bng_3 log:isImpliedBy _:bng_4.
_:bng_5 log:isImpliedBy _:bng_6.
_:bng_7 log:isImpliedBy _:bng_8.
_:bng_9 log:isImpliedBy _:bng_10.
_:bng_11 log:isImpliedBy _:bng_12.
_:bng_13 log:isImpliedBy _:bng_14.
_:bng_15 log:isImpliedBy _:bng_16.
_:bng_17 log:isImpliedBy _:bng_18.
_:bng_19 log:isImpliedBy _:bng_20.
_:bng_21 log:isImpliedBy _:bng_22.
_:bng_23 log:isImpliedBy _:bng_24.
_:bng_25 log:isImpliedBy _:bng_26.
_:bng_27 log:isImpliedBy _:bng_28.
_:bng_29 log:isImpliedBy _:bng_30.
_:bng_31 log:isImpliedBy _:bng_32.

_:bng_1 {
    (var:x_0 var:x_1 var:x_2) :route var:x_3.
}

_:bng_2 {
    (var:x_1 ((var:x_0) ()) var:x_2) :waves var:x_4.
    (var:x_0 var:x_1 var:x_4) :path var:x_5.
    var:x_5 list:reverse var:x_3.
}

_:bng_3 {
    (var:x_6 var:x_7 var:x_8) :waves var:x_9.
}

_:bng_4 {
    var:x_7 list:firstRest (var:x_10 var:x_9).
    var:x_10 list:member var:x_6.
    [] <http://www.w3.org/1999/02/22-rdf-syntax-ns#value> true; log:callWithCut true.
}

_:bng_5 {
    (var:x_11 var:x_12 var:x_13) :waves var:x_14.
}

_:bng_6 {
    var:x_12 list:firstRest (var:x_15 var:x_16).
    var:x_16 list:firstRest (var:x_17 var:x_18).
    (var:x_20 _:bng_33 var:x_21) log:collectAllIn var:x_19.
    var:x_21 list:sort var:x_22.
    var:x_23 list:firstRest (var:x_22 var:x_12).
    (var:x_11 var:x_23 var:x_13) :waves var:x_14.
}

_:bng_7 {
    (var:x_24 var:x_25 var:x_26) :admissible var:x_27.
}

_:bng_8 {
    (var:x_24 var:x_25) :adjacent var:x_27.
    var:x_28 log:notIncludes _:bng_34.
    var:x_28 log:notIncludes _:bng_35.
}

_:bng_9 {
    (var:x_29 var:x_30) :adjacent var:x_31.
}

_:bng_10 {
    var:x_30 list:member var:x_32.
    var:x_32 :neighbor var:x_29.
    var:x_33 log:notIncludes _:bng_36.
}

_:bng_11 {
    (var:x_34 var:x_35) :neighbor (var:x_36 var:x_35).
}

_:bng_12 {
    var:x_34 :next_to var:x_36.
}

_:bng_13 {
    (var:x_37 var:x_38) :neighbor (var:x_37 var:x_39).
}

_:bng_14 {
    var:x_38 :next_to var:x_39.
}

_:bng_15 {
    var:x_40 :next_to var:x_41.
}

_:bng_16 {
    (var:x_40 1) math:sum var:x_41.
}

_:bng_17 {
    var:x_42 :next_to var:x_43.
}

_:bng_18 {
    var:x_42 math:greaterThan 0 .
    (var:x_42 -1) math:sum var:x_43.
}

_:bng_19 {
    var:x_44 :obstructed var:x_45.
}

_:bng_20 {
    var:x_45 list:member var:x_46.
    var:x_44 :obstructs var:x_46.
}

_:bng_21 {
    (var:x_47 var:x_48) :obstructs ((var:x_47 var:x_49) (var:x_50 var:x_51)).
}

_:bng_22 {
    var:x_49 math:notGreaterThan var:x_48.
    var:x_48 math:notGreaterThan var:x_51.
}

_:bng_23 {
    (var:x_52 var:x_53) :obstructs ((var:x_54 var:x_55) (var:x_52 var:x_56)).
}

_:bng_24 {
    var:x_55 math:notGreaterThan var:x_53.
    var:x_53 math:notGreaterThan var:x_56.
}

_:bng_25 {
    (var:x_57 var:x_58) :obstructs ((var:x_59 var:x_58) (var:x_60 var:x_61)).
}

_:bng_26 {
    var:x_59 math:notGreaterThan var:x_57.
    var:x_57 math:notGreaterThan var:x_60.
}

_:bng_27 {
    (var:x_62 var:x_63) :obstructs ((var:x_64 var:x_65) (var:x_66 var:x_63)).
}

_:bng_28 {
    var:x_64 math:notGreaterThan var:x_62.
    var:x_62 math:notGreaterThan var:x_66.
}

_:bng_29 {
    (var:x_67 var:x_67 var:x_68) :path (var:x_67).
}

_:bng_30 {
    [] <http://www.w3.org/1999/02/22-rdf-syntax-ns#value> true; log:callWithCut true.
}

_:bng_31 {
    (var:x_69 var:x_70 var:x_71) :path var:x_72.
}

_:bng_32 {
    var:x_71 list:firstRest (var:x_73 var:x_74).
    var:x_72 list:firstRest (var:x_70 var:x_75).
    var:x_73 list:member var:x_76.
    var:x_70 :neighbor var:x_76.
    [] <http://www.w3.org/1999/02/22-rdf-syntax-ns#value> true; log:callWithCut true.
    (var:x_69 var:x_76 var:x_74) :path var:x_75.
}

_:bng_33 {
    (var:x_20 var:x_15 var:x_17) :admissible var:x_13.
}

_:bng_34 {
    var:x_26 list:member var:x_24.
}

_:bng_35 {
    var:x_25 list:member var:x_24.
}

_:bng_36 {
    var:x_29 :obstructed var:x_31.
}

# query
_:bng_37 log:query _:bng_37.

_:bng_37 {
    ((1 1) (9 8) (((2 3) (4 5)) ((6 6) (8 8)))) :route var:R.
}

