# Gray Code Counter
# See https://en.wikipedia.org/wiki/Gray_code
# Taken from the book "Clause and Effect" Chapter 8

@prefix log: <http://www.w3.org/2000/10/swap/log#>.
@prefix list: <http://www.w3.org/2000/10/swap/list#>.
@prefix : <http://example.org/ns#>.

(0 0) :and 0.
(0 1) :and 0.
(1 0) :and 0.
(1 1) :and 1.

(0 0) :or 0.
(0 1) :or 1.
(1 0) :or 1.
(1 1) :or 1.

0 :inv 1.
1 :inv 0.

(?D ?Q) log:onNegativeSurface {
    () log:onNegativeSurface <<(?D 0 ?Q) :dff ?Q>>.
}.

(?D ?Q) log:onNegativeSurface {
    () log:onNegativeSurface <<(?D 1 ?Q) :dff ?D>>.
}.

(?A ?B ?Q ?T1 ?NA ?NB ?T2) log:onNegativeSurface {
    () log:onNegativeSurface <<(?A ?B) :neta ?Q>>.
    (?A ?B) :and ?T1.
    ?A :inv ?NA.
    ?B :inv ?NB.
    (?NA ?NB) :and ?T2.
    (?T1 ?T2) :or ?Q.
}.

(?A ?B ?C ?Q1 ?Q2 ?T1 ?NC ?T2 ?NA ?T3) log:onNegativeSurface {
    () log:onNegativeSurface <<(?A ?B ?C) :netb (?Q1 ?Q2)>>.
    (?A ?C) :and ?T1.
    ?C :inv ?NC.
    (?B ?NC) :and ?T2.
    ?A :inv ?NA.
    (?NA ?C) :and ?T3.
    (?T1 ?T2) :or ?Q1.
    (?T2 ?T3) :or ?Q2.
}.


(?C ?Qa ?Qb ?Qc ?Za ?Zb ?Zc ?D1 ?D2 ?D3) log:onNegativeSurface {
    () log:onNegativeSurface <<(?C (?Qa ?Qb ?Qc)) :gcc (?Za ?Zb ?Zc)>>.
    (?Qa ?Qb ?Qc) :netb (?D1 ?D2).
    (?Qa ?Qb) :neta ?D3.
    (?D1 ?C ?Qa) :dff ?Za.
    (?D2 ?C ?Qb) :dff ?Zb.
    (?D3 ?C ?Qc) :dff ?Zc.
}.


(?S) log:onNegativeSurface {
    () log:onNegativeSurface <<(() ?S) :testgcc ()>>.
}.

(?Cc ?S ?Nc ?C ?Cs ?N ?Ns) log:onNegativeSurface {
    () log:onNegativeSurface <<(?Cc ?S) :testgcc ?Nc>>.
    ?Cc list:firstRest (?C ?Cs).
    ?Nc list:firstRest (?N ?Ns).
    (?C ?S) :gcc ?N.
    (?Cs ?N) :testgcc ?Ns.
}.

# query
(?Q) log:onQuerySurface {
    ((1 1 1 1 1 1 1 1 1) (0 0 0)) :testgcc ?Q.
}.
